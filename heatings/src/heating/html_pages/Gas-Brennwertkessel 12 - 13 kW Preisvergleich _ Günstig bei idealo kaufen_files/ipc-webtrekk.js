$(function(){window.idealo=window.idealo||{};Webtrekk=function(){var that=this,ampersandReplacement="";that.wtSelectors={categoryListeFilterID:"#filter-category",colorListeFilterID:"#filter-color",priceListeFilterID:"#filter-price",priceListeFilterPriceMin:"#rangemin",priceListeFilterPriceMax:"#rangemax",priceListeFilterPriceMinOld:"#rangeminOld",priceListeFilterPriceMaxOld:"#rangemaxOld"};function constructor(){initAmpersandReplacement()}function getMeta(name){var $Meta;if($("meta[name="+name+"]").size()>0){$Meta=$("meta[name="+name+"]")}else{$Meta=$("meta[http-equiv="+name+"]")}return $Meta.attr("content")}function initAmpersandReplacement(){switch(getMeta("language")){case"de":case"de-DE":case"at":case"at-AT":ampersandReplacement="und";break;case"it":case"it-IT":ampersandReplacement="e";break;case"es":case"es-ES":ampersandReplacement="y";break;case"pl":case"pl-PL":ampersandReplacement="i";break;case"et":case"et-ET":ampersandReplacement="et";break;case"en":case"en-GB":ampersandReplacement="and";break;default:ampersandReplacement="and"}}function convertString(string){if(typeof string==="undefined"){return""}var result=string,before=["ö","ä","ü","ß","ú","û","ù","ó","ô","ò","ã","å","à","â","á","ë","ê","é","è","ï","í","ì","î"],after=["oe","ae","ue","ss","u","u","u","o","o","o","a","a","a","a","a","e","e","e","e","i","i","i","i"];result=result.replace(/-, /g,"-_");result=result.replace(/-\//g,"-");result=result.replace(/ & /g,"_"+ampersandReplacement+"_");result=result.replace(/idealo./g,"idealo_");result=result.replace(/(- & |-& )/g,"-_"+ampersandReplacement+"_");result=result.toLowerCase();for(var i=0;i<before.length;i++){var re=new RegExp(before[i],"gi");result=result.replace(re,after[i])}result=result.replace(/[^a-z0-9_\-\+\. ]/g,"");result=result.replace(/( +|\/|_+)/g,"_");result=result.replace(/_$/,"");return result}that.trackConversion=function(){var regex=/^\/preisvergleich\/Relocate\/|^\/go\//,leadoutSet=false;$("a").each(function(index){var $a=$(this),url=$a.attr("href");if(regex.exec(url)!==null){var params={};url.split("?")[1].replace(/([^&=]+)=?([^&]*)(?:&+|$)/g,function(match,key,value){params[key]=value});if((params["type"]=="offer"||params["type"]=="oc_offer")&&typeof wt!==undefined){if(typeof wt.unregisterEvent=="function"){wt.unregisterEvent($a,"mousedown");$a.mousedown(function(event){wt.productStatus="conf";if(leadoutSet===false){var lastProp=0;for(var propertyName in wt.contentGroup){var pint=parseInt(propertyName,10);if(pint>lastProp){lastProp=pint}}lastProp=lastProp+1+"";wt.contentGroup[lastProp]="leadout";wt.contentId+=".leadout";leadoutSet=true}wt.sendinfo()})}}}})};that.trackMainNavi=function(){var $mainnavi=$(".navi-main");$mainnavi.find("a").click(function(event){var $target=$(this),linkId="nav",position=false,wtSendParams={};if($(this).parents(".navi-sub").length>0){var $li=$target.closest("li"),liText=convertString($li.find(".navi-link").text());aText=convertString($target.text());linkId+="."+liText+"."+aText;if($target.closest("td").hasClass("more")){position="sub"}else{var liPos=$mainnavi.find("li").index($li);var aPos=$li.find("table.navi-sub a").index($target)+1;position=liPos+"-"+aPos}}else if($target.parents(".navi-main").length>0){var liText2=convertString($target.text());if($target.closest("li").hasClass("cat-all")){linkId+=".sitemap"}else{linkId+="."+liText2;position=$mainnavi.find("li").index($target.closest("li"))+"-0"}}wtSendParams.linkId=linkId;if($target.attr("target")==="_blank"){wtSendParams.sendOnUnload=0}else{wtSendParams.sendOnUnload=1}if(position!==false){wtSendParams.customClickParameter={1:String(position)}}if(linkId!=="nav"&&typeof wt!="undefined"){wt.sendinfo(wtSendParams)}})};that.trackActions=function(){$("a.webtrekk,button.webtrekk").mousedown(function(event){var $that=$(this),linkid=$(this).data("wt-linkid"),param=$(this).data("wt-param"),param2=$(this).data("wt-param2");if(typeof wt!=="undefined"&&typeof linkid!=="undefined"){var wtSendParams={linkId:linkid,sendOnUnload:1},customClickParams={};if($that.hasClass("wt-prompt")){wtSendParams.sendOnUnload=0}if(typeof param!=="undefined"){customClickParams[1]=convertString(String(param))}if(typeof param2!=="undefined"){customClickParams[2]=convertString(String(param2))}wtSendParams.customClickParameter=customClickParams;wt.sendinfo(wtSendParams)}});$(document).bind("webtrekk-click",function(event,linkid){var wtSendParams={linkId:convertString(linkid)},customClickParams={},customClickParamCount=1,i=2,arg=null;for(i;i<arguments.length;i++){arg=arguments[i];if(typeof arg==="string"){customClickParams[customClickParamCount++]=convertString(arg)}}if(typeof wt!=="undefined"&&typeof linkid!=="undefined"){wtSendParams.customClickParameter=customClickParams;wt.sendinfo(wtSendParams)}})};that.trackTyreConsultant=function(){$("#tyre-consultant button").mousedown(function(event){var linkid=$(this).data("wt-linkid"),param="",param2=[];$("#tyre-consultant select").each(function(index){$this=$(this);param2[index]=$("option:selected",$this).text()});param2=param2.join(".");if(typeof wt!=="undefined"&&typeof linkid!=="undefined"){var wtSendParams={linkId:linkid,sendOnUnload:1},customClickParams={};if(typeof param!=="undefined"){customClickParams[1]=convertString(String(param))}if(typeof param2!=="undefined"){customClickParams[2]=convertString(String(param2))}wtSendParams.customClickParameter=customClickParams;wt.sendinfo(wtSendParams)}})};that.trackHome=function(){var trackingStringMap={"header.bild":"header.bild","videos.navi":"videos.navi","videos.videolink":"videos.videolink","HP-clickedTab-favourits":"teaser.produkte","HP-favouritsPId-":"teaser.produkte.slider.pic","HP-favourits-slideNext-aktiviert":"teaser.produkte.slider.slidernavi","HP-favourits-slidePrev-aktiviert":"teaser.produkte.slider.slidernavi","HP-clickedTab-season":"teaser.highlight","HP-season-nextHighlight":"teaser.highlight.navi","HP-season-categorylink":"teaser.highlight.categorylink","HP-clickedTab-test-winners":"teaser.testsieger","HP-test-winners-slidePrev-aktiviert":"teaser.testsieger.slider.slidernavi","HP-test-winners-slideNext-aktiviert":"teaser.testsieger.slider.slidernavi","HP-testWinnersPId-":"teaser.testsieger.slider.pic","HP-clickedTab-flights":"teaser.fluege","tab.flug.bigbutton":"tab.flug.bigbutton","tab.flug.button":"tab.flug.button","tab.flug.map":"tab.flug.map","verticals.flug.button":"verticals.flug.button","HP-clickedTab-android-app":"teaser.android","HP-clickedTab-certificate":"teaser.tuv"},getLinkId=function(trackingString){var linkId,prefix=null;if(typeof trackingStringMap[trackingString]==="undefined"){winner=trackingString.match(/^HP-testWinnersPId-/);favour=trackingString.match(/^HP-favouritsPId-/);if(winner!==null){prefix=winner[0]||null}else if(favour!==null){prefix=favour[0]||null}if(prefix!==null){linkId=trackingStringMap[prefix]}}else{linkId=trackingStringMap[trackingString]}return linkId},getSeasonTabPos=function(){var pos=null;$("#tab-box #dot-slider .dots div").each(function(index){if($(this).hasClass("dot-active")){pos=index+1;return false}});return pos},getFavourPicPos=function(){var pos=null;$("#tab-box #favourits-carousel li").each(function(index){if($(this).hasClass("active")){pos=index+1;return false}});return pos},getWinnerPicPos=function(){var pos=null;$("#tab-box #test-winners-carousel li").each(function(index){if($(this).hasClass("active")){pos=index+1;return false}});return pos};$(document).unbind("webtrekk-click");$(document).bind("webtrekk-click",function(event,trackingString,param1,param2){var lid=getLinkId(trackingString),pos=null;if(typeof param1!=="undefined"){pos=param1}else{switch(lid){case"teaser.highlight.navi":pos=getSeasonTabPos();break;case"teaser.testsieger.slider.pic":pos=getWinnerPicPos();break;case"teaser.produkte.slider.pic":pos=getFavourPicPos();break;default:lid=trackingString;pos=param1}}if(typeof wt!=="undefined"&&typeof lid!=="undefined"){var wtSendParams={linkId:lid};if(pos!==null&&typeof pos!=="undefined"){wtSendParams.customClickParameter={1:String(pos),2:String(param2)}}wt.sendinfo(wtSendParams)}})};that.trackSuggest=function(){var $sf=$("#searchField"),prefix="suche.suggest.",itemPos=0,getSuggestType=function($el){var $prev=$el.prev();itemPos++;if($prev.hasClass("suggesthead")){return false}else if($prev.hasClass("suggesttype")){return $prev.attr("id")}else{return getSuggestType($prev)}};$sf.keypress(function(event){if(event.which===13){var wtSendParams={linkId:"suche.enter",sendOnUnload:1};wt.sendinfo(wtSendParams)}itemPos=0;var $acs=$("#acsuggest").unbind("mouseenter").one("mouseenter",function(event){$acs.find(".suggestitem").mousedown(function(event){var wtSendParams={linkId:prefix+getSuggestType($(this)),sendOnUnload:1,customClickParameter:{1:String(itemPos)}};wt.sendinfo(wtSendParams)})})});$("#submitButton").mousedown(function(event){var wtSendParams={linkId:"suche.button",sendOnUnload:1};wt.sendinfo(wtSendParams)});$("#search_local").parent().mousedown(function(event){var wtSendParams={linkId:"suche.bereich"};wt.sendinfo(wtSendParams)});$("#search_global").parent().mousedown(function(event){var wtSendParams={linkId:"suche.global"};wt.sendinfo(wtSendParams)})};that.trackFilter=function(){var filterTracker={init:function(){this.trackCategoryFilter();this.trackColorFilter();this.trackPriceFilter();this.trackSearchFilter();this.trackAllFilterPage();this.trackHitmap()},trackCategoryFilter:function(){var self=this,$box=$(that.wtSelectors.categoryListeFilterID),lid=$box.data("wt-linkid"),pos=1;$box.find("a").each(function(index){var $a=$(this);if($a.hasClass("wt-reset")){$a.click(function(event){self.send(lid,false,"reset")})}else{$a.data("pos",pos);$a.click(function(event){$this=$(this);self.send(lid,String($this.data("pos")),$this.text())});pos++}})},trackColorFilter:function(){var self=this,$box=$(that.wtSelectors.colorListeFilterID),lid=$box.data("wt-linkid"),pos=1;$box.find("a").each(function(){var $a=$(this);if(!$a.hasClass("wt-reset")){$a.data("pos",pos);$a.click(function(event){var linkId=lid,$this=$(this);if(typeof $this.find(".wt-checked")[0]!=="undefined"){linkId+=".remove"}self.send(linkId,String($this.data("pos")),$this.attr("title"))});pos++}else{$a.click(function(event){self.send(lid,false,"reset")})}})},trackPriceFilter:function(){var self=this,$box=$(that.wtSelectors.priceListeFilterID),lid=$box.data("wt-linkid"),price=0,slider="";$box.find("a").each(function(index){var $a=$(this);if($a.hasClass("wt-reset")){$a.click(function(event){self.send(lid,false,"reset")})}else{$a.mouseup(function(event){switch(index){case 0:price=$box.find(that.wtSelectors.priceListeFilterPriceMin).val();slider="left";break;case 1:price=$box.find(that.wtSelectors.priceListeFilterPriceMax).val();slider="right";break}self.send(lid+"-slider",slider,price)})}});$box.find("button").click(function(event){price=$box.find(that.wtSelectors.priceListeFilterPriceMinOld).val()+"-"+$box.find(that.wtSelectors.priceListeFilterPriceMaxOld).val();self.send("button",false,price)})},trackSearchFilter:function(){var self=this;$(".wt-search-filter").each(function(){var $sf=$(this),lid="filter.specific."+convertString($sf.data("wt-filtertype"));$sf.find("a").each(function(index){var $a=$(this);$a.click(function(event){var val=$a.text(),rest=val.indexOf("(");if(rest>1){val=val.slice(0,rest)}self.send(lid,String(index+1),val)})})});$(".wt-more-search-filter ul li a").each(function(index){var $a=$(this);$a.click(function(event){self.send("filter.morefilter",String(index+1),$a.text())})})},trackAllFilterPage:function(){var self=this;$(".wt-filterlist").each(function(fidx){$(this).find("a").each(function(aidx){$(this).click(function(event){var filtertype=$("#all-filters-tbl .subheading:eq("+fidx+")").data("wt-filtertype"),filtername=$(this).text(),rest=filtername.indexOf("("),lid="filter.specific."+convertString(filtertype);if($(this).hasClass("wt-checked")){lid+=".remove"}if(rest>1){filtername=filtername.slice(0,rest)}self.send(lid,String(aidx+1),filtername)})})});$(".wt-selected-filter-cnt").each(function(tidx){var $sftbl=$(this),pos="";switch(tidx){case 0:pos="top";break;case 1:pos="bottom";break}$sftbl.find(".wt-show-filtered-btn").click(function(event){self.send("filter.showfiltered",pos)});$sftbl.find(".wt-selected-filter-cb").click(function(event){var cbcount=$sftbl.find(".wt-selected-filter-cb").length-1;self.send("filter.remove",pos,String(cbcount))});$sftbl.find(".wt-clear-selected-filter-btn").click(function(event){var cbcount=$sftbl.find(".wt-selected-filter-cb").length;self.send("filter.clearall",pos,String(cbcount))})})},trackHitmap:function(){var self=this,lid="filter.hitmap",lcount=1;$(".wt-hitmap a").each(function(idx){var $this=$(this);if($this.attr("id")!=="morePcatsLink"){$this.data("index",lcount);$this.click(function(event){var linktext=$(this).text(),rest=linktext.indexOf("(");if(rest>1){linktext=linktext.slice(0,rest)}self.send(lid,String($this.data("index")),linktext)});lcount++}})},send:function(lid){var wtSendParams={linkId:lid,sendOnUnload:1},customClickParams={},customClickParamCount=1,i=1,arg=null;for(i;i<arguments.length;i++){arg=arguments[i];if(typeof arg==="string"){customClickParams[customClickParamCount++]=convertString(arg)}else if(arg===false){customClickParamCount++}}wtSendParams.customClickParameter=customClickParams;wtSendParams.sendOnUnload=1;wt.sendinfo(wtSendParams)}};filterTracker.init()};that.trackPostalServiceProviderIcons=function(){$(".sprite-psp-icon").on("mousedown mouseover",function(e){wt.sendinfo({linkId:(e.type==="mousedown"?"click":"hover")+"-OOP-"+$(this).data("psp")})})};that.trackTileDetailPopups=function(){$(".tile .link-details-popup, .tile .shipping, .tile-view-table .details").on("mousedown",function(){wt.sendinfo({linkId:"preisvergleich.detail."+$(this).data("type")})})};constructor()};var iwt=new Webtrekk;iwt.trackConversion();iwt.trackMainNavi();iwt.trackActions();iwt.trackTyreConsultant();iwt.trackSuggest();iwt.trackFilter();iwt.trackPostalServiceProviderIcons();iwt.trackTileDetailPopups();if(typeof $("body#homepage")[0]!=="undefined"){iwt.trackHome()}window.idealo.Webtrekk=new(function(){var _mouseenterHanlder=function(event){var $element=$(this),sendParams,params=JSON.parse($element.data("wt-mouseenter").replace(/\'/g,'"'));if(!params.id||typeof params.id!=="string"){return}sendParams={linkId:params.id,sendOnUnload:params.sendOnUnload||0};wt.sendinfo(sendParams)},_mousedownHandler=function(event){var $el=$(this),attrs=JSON.parse($el.data("wt-click").replace(/\'/g,'"')),target=$el.attr("target")||"_self",sendParams={linkId:attrs.id||null,customClickParameter:attrs.params};if(typeof attrs.id!=="string"){return}if(attrs.relocate){$el.attr("href",attrs.relocate)}if($el.attr("href")){if(target==="_blank"){wt.sendinfo(sendParams)}else{$el.click(function(event){event.preventDefault();event.stopPropagation();wt.sendinfo(sendParams);setTimeout(function(){window.location.href=$el.attr("href")},400)})}}else{wt.sendinfo(sendParams)}};function Webtrekk(){var c=this;c.customEventTracking()}Webtrekk.prototype.customEventTracking=function(container){var c=container||$;$(c.find("*[data-wt-mouseenter]")).each(function(){$(this).unbind("mouseenter",_mouseenterHanlder).bind("mouseenter",_mouseenterHanlder)});$(c.find("*[data-wt-click]")).each(function(){$(this).unbind("mousedown",_mousedownHandler).bind("mousedown",_mousedownHandler)})};return Webtrekk}())});